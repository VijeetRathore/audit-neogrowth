<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Branch Compliance Audit</title>

<style>
body{font-family:Arial;padding:20px}
.section{border:1px solid #aaa;padding:15px;margin-top:20px}
.hidden{display:none}
label{font-weight:bold}
hr{margin:15px 0}
  
.preview-img {
  width: 100px;
  height: 100px;
  object-fit: cover;
  margin-top: 10px;
  border: 1px solid #ddd;
  display: none; /* Shuruat mein hidden rahega */
}
</style>
</head>

<body>

<h2>Branch Compliance Audit</h2>

<!-- ================= BASIC DETAILS ================= -->

<label>Select State</label><br>
<select id="state" onchange="loadBranches();applyLanguage()">
<option value="">--Select--</option>
<option value="Andhra Pradesh">ఆంధ్రప్రదేశ్ / Andhra Pradesh</option>
<option value="Telangana">తెలంగాణ / Telangana</option>
<option value="Tamil Nadu">தமிழ்நாடு / Tamil Nadu</option>
<option value="Karnataka">ಕರ್ನಾಟಕ / Karnataka</option>
<option value="Delhi">दिल्ली / Delhi</option>
<option value="Gujarat">गुजरात / Gujarat</option>
<option value="Maharashtra">महाराष्ट्र / Maharashtra</option>
<option value="Rajasthan">राजस्थान / Rajasthan</option>
<option value="Uttar Pradesh">उत्तर प्रदेश / Uttar Pradesh</option>
<option value="West Bengal">পশ্চিমবঙ্গ / West Bengal</option>
<option value="Punjab">ਪੰਜਾਬ / Punjab</option>
<option value="Haryana">हरियाणा / Haryana</option>
<option value="Madhya Pradesh">मध्य प्रदेश / Madhya Pradesh</option>
<option value="Odisha">ଓଡ଼ିଶା / Odisha</option>
<option value="Puducherry">புதுச்சேரி / Puducherry</option>
<option value="Jharkhand">झारखंड / Jharkhand</option>
<option value="Chandigarh">चंडीगढ़ / Chandigarh</option>
</select>

<br><br>

<label>Select Branch</label><br>
<select id="branch" onchange="checkConditions()"></select>

<br><br>

<label>Name of Branch Head</label><br>
<input type="text" id="branchHead">

<br><br>

<label>Name of Office Boy</label><br>
<input type="text" id="officeBoy">

<!-- ================= COMPLIANCE ================= -->

<div class="section">
<h3>Compliance</h3>

<script>
function questionBlock(qid){
  let isSimple = (qid === "q1" || qid === "q2");

  document.write(`
    <p id="${qid}Text"></p>
    <input type="radio" name="${qid}" onclick="toggle('${qid}',true)" required> Yes
    <input type="radio" name="${qid}" onclick="toggle('${qid}',false)" required> No
    <div id="${qid}" class="hidden">
      ${isSimple ? '' : `
        Version No <input type="text" class="detail-input"><br>
        Issue Date <input type="date" class="detail-input"><br>
        Effective Date <input type="date" class="detail-input"><br>
      `}
      <input type="file" accept="image/*" onchange="showPreview(event, '${qid}Img')">
      <br><img id="${qid}Img" class="preview-img">
    </div>
    <hr>
  `);
}
</script>

<script>
["q1","q2","q3","q4","q5","q6","q7","q8","q9","q10"].forEach(questionBlock);
</script>

<!-- File only questions -->
<script>
["q11","q12","q13","q14","q15","q16"].forEach(q=>{
  document.write(`
    <p id="${q}Text"></p>
    <input type="radio" name="${q}" onclick="toggle('${q}',true)"> Yes
    <input type="radio" name="${q}" onclick="toggle('${q}',false)"> No
    <div id="${q}" class="hidden">
      <input type="file" accept="image/*" onchange="showPreview(event, '${q}Img')">
      <br><img id="${q}Img" class="preview-img">
    </div>
    <hr>
  `);
});
</script>

<!-- Trade License -->
<div id="tradeSection" class="hidden">
  <p id="q17Text"></p>
  <input type="radio" name="q17" onclick="toggle('q17Div',true)"> Yes
  <input type="radio" name="q17" onclick="toggle('q17Div',false)"> No
  <div id="q17Div" class="hidden">
    <input type="file" accept="image/*" onchange="showPreview(event, 'q17Img')">
    <br><img id="q17Img" class="preview-img">
  </div>
  <hr>
</div>

<!-- ISO -->
<div id="isoSection" class="hidden">
  <p id="q18Text"></p>
  <input type="radio" name="q18" onclick="toggle('q18Div',true)"> Yes
  <input type="radio" name="q18" onclick="toggle('q18Div',false)"> No
  <div id="q18Div" class="hidden">
    <input type="file" accept="image/*" onchange="showPreview(event, 'q18Img')">
    <br><img id="q18Img" class="preview-img">
  </div>
</div>

</div>

<button onclick="submitForm()">Submit Audit to Excel</button>
 <script>
async function submitForm() {
  const submitBtn = event.target;
  submitBtn.innerText = "Sending...";
  submitBtn.disabled = true;

  const auditData = {
    state: document.getElementById('state').value,
    branch: document.getElementById('branch').value,
    branchHead: document.getElementById('branchHead').value,
    officeBoy: document.getElementById('officeBoy').value,
    responses: {}
  };

  for (let i = 1; i <= 18; i++) {
    let qid = 'q' + i;
    let radio = document.querySelector(`input[name="${qid}"]:checked`);
    let img = document.getElementById(qid + 'Img');

    auditData.responses[qid] = {
      answer: radio ? radio.value : "",
      version: document.querySelector(`#${qid} input.detail-input:nth-of-type(1)`)?.value || "",
      issueDate: document.querySelector(`#${qid} input.detail-input:nth-of-type(2)`)?.value || "",
      effectiveDate: document.querySelector(`#${qid} input.detail-input:nth-of-type(3)`)?.value || "",
      photo: (img && img.src.startsWith('data:image')) ? img.src : ""
    };
  }

  const webhookURL = "https://script.google.com/macros/s/AKfycbypcxId7PS2IXjc8f0P0thk--CUjTDDTur7RltmNNyd0eXJiidXaXe5bo_QnLbg8KXv/exec";

  try {
    const response = await fetch(webhookURL, {
      method: "POST",
      body: JSON.stringify(auditData),
      headers: { "Content-Type": "application/json" }
    });

    if (response.ok) {
      alert("Data aur Photos Excel mein save ho gaye hain!");
    } else {
      alert("Error: Data nahi bheja ja saka.");
    }
  } catch (err) {
    console.error(err);
    alert("Connection Error!");
  } finally {
    submitBtn.innerText = "Submit Audit to Excel";
    submitBtn.disabled = false;
  }
}
</script>
<!-- ================= SCRIPT ================= -->

<script>
function toggle(id,show){
 document.getElementById(id).style.display = show ? "block" : "none";
}

const branchMap={
"Andhra Pradesh":["Tirupati","Vijayawada","Visakhapatnam"],
"Telangana":["Hyderabad"],
"Tamil Nadu":["Chennai","Coimbatore","Madurai","Salem","Tirupur","Tiruvallur"],
"Karnataka":["Bangalore","Belgaum","Gulbarga","Hubballi","Mangalore","Mysore","Tumkur"],
"Delhi":["Delhi"],
"Gujarat":["Ahmedabad","Baroda","Rajkot","Surat"],
"Maharashtra":["Aurangabad","Borivali","Kolhapur","Nagpur","Nashik","Pune","Thane"],
"Rajasthan":["Ajmer","Jaipur","Jodhpur","Sikar","Udaipur"],
"Uttar Pradesh":["Lucknow"],
"West Bengal":["Kolkata"],
"Punjab":["Jalandhar","Ludhiana"],
"Haryana":["Panipat"],
"Madhya Pradesh":["Bhopal","Gwalior","Indore"],
"Odisha":["Bhubaneswar"],
"Puducherry":["Puducherry"],
"Jharkhand":["Jamshedpur"],
"Chandigarh":["Chandigarh"]
};

const trade=["Bhubaneswar","Hyderabad","Kolkata","Puducherry","Tirupati"];
const iso=["Bangalore","Chennai","Delhi","Hyderabad","Jaipur","Pune","Kolkata","Coimbatore","Ahmedabad"];

function loadBranches(){
branch.innerHTML="";
(branchMap[state.value]||[]).forEach(b=>{
let o=document.createElement("option");
o.text=o.value=b;
branch.add(o);
});
checkConditions();
}

function checkConditions(){
tradeSection.style.display = trade.includes(branch.value) ? "block" : "none";
isoSection.style.display = iso.includes(branch.value) ? "block" : "none";
}
</script>

<script>
const QUESTIONS={
q1:{hi:"क्या RBI certificate  Notice बोर्ड पर प्रदर्शित है?/Is RBI certificate displayed on the notice Board?",
te:"నోటీసు బోర్డులో  RBI certificate   ప్రదర్శించబడిందా?/Is RBI certificate displayed on the notice Board?",
ta:"அறிவிப்பு பலகையில் RBI certificate  காட்டப்பட்டுள்ளதா?/Is RBI certificate displayed on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  RBI certificate ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is RBI certificate displayed on the notice Board?"},
q2:{hi:"क्या Certificate of Incorporation  Notice बोर्ड पर प्रदर्शित है?/Is Certificate of Incorporation displayed on notice board?",
te:"నోటీసు బోర్డులో  Certificate of Incorporation   ప్రదర్శించబడిందా?/Is Certificate of Incorporation displayed on notice board?",
ta:"அறிவிப்பு பலகையில் Certificate of Incorporation  காட்டப்பட்டுள்ளதா?/Is Certificate of Incorporation displayed on notice board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Certificate of Incorporation ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Certificate of Incorporation displayed on notice board?"},
q3:{hi:"क्या Grievance Redressal Policy  Notice बोर्ड पर प्रदर्शित है?/Is Grievance Redressal Policy on the notice Board?",
te:"నోటీసు బోర్డులో  Grievance Redressal Policy   ప్రదర్శించబడిందా?/Is Grievance Redressal Policy on the notice Board?",
ta:"அறிவிப்பு பலகையில் Grievance Redressal Policy  காட்டப்பட்டுள்ளதா?/Is Grievance Redressal Policy on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Grievance Redressal Policy ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Grievance Redressal Policy on the notice Board?"},
q4:{hi:"क्या Employee Grievance Resolution Policy  Notice बोर्ड पर प्रदर्शित है?/Is Employee Grievance Resolution Policy on the notice Board?",
te:"నోటీసు బోర్డులో  Employee Grievance Resolution Policy   ప్రదర్శించబడిందా?/Is Employee Grievance Resolution Policy on the notice Board?",
ta:"அறிவிப்பு பலகையில் Employee Grievance Resolution Policy  காட்டப்பட்டுள்ளதா?/Is Employee Grievance Resolution Policy on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Employee Grievance Resolution Policy ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Employee Grievance Resolution Policy on the notice Board?"},
q5:{hi:"क्या Collection code of conduct  Notice बोर्ड पर प्रदर्शित है?/Is Collection code of conduct on the notice Board?",
te:"నోటీసు బోర్డులో  Collection code of conduct   ప్రదర్శించబడిందా?/Is Collection code of conduct on the notice Board?",
ta:"அறிவிப்பு பலகையில் Collection code of conduct  காட்டப்பட்டுள்ளதா?/Is Collection code of conduct on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Collection code of conduct ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Collection code of conduct on the notice Board?"},
q6:{hi:"क्या Whistle Blower Policy  Notice बोर्ड पर प्रदर्शित है?/Is Whistle Blower Policy on the notice Board?",
te:"నోటీసు బోర్డులో  Whistle Blower Policy   ప్రదర్శించబడిందా?/Is Whistle Blower Policy on the notice Board?",
ta:"அறிவிப்பு பலகையில் Whistle Blower Policy  காட்டப்பட்டுள்ளதா?/Is Whistle Blower Policy on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Whistle Blower Policy ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Whistle Blower Policy on the notice Board?"},
q7:{hi:"क्या Code of conduct  Notice बोर्ड पर प्रदर्शित है?/Is Code of conduct on the notice Board?",
te:"నోటీసు బోర్డులో  Code of conduct   ప్రదర్శించబడిందా?/Is Code of conduct on the notice Board?",
ta:"அறிவிப்பு பலகையில் Code of conduct  காட்டப்பட்டுள்ளதா?/Is Code of conduct on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Code of conduct ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Code of conduct on the notice Board?"},
q8:{hi:"क्या Quality Policy  Notice बोर्ड पर प्रदर्शित है?/Is Quality Policy on the notice Board?",
te:"నోటీసు బోర్డులో  Quality Policy   ప్రదర్శించబడిందా?/Is Quality Policy on the notice Board?",
ta:"அறிவிப்பு பலகையில் Quality Policy  காட்டப்பட்டுள்ளதா?/Is Quality Policy on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Quality Policy ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Quality Policy on the notice Board?"},
q9:{hi:"क्या Sexual Harassment policy  Notice बोर्ड पर प्रदर्शित है?/Is Sexual Harassment policy on the notice Board?",
te:"నోటీసు బోర్డులో  Sexual Harassment policy   ప్రదర్శించబడిందా?/Is Sexual Harassment policy on the notice Board?",
ta:"அறிவிப்பு பலகையில் Sexual Harassment policy  காட்டப்பட்டுள்ளதா?/Is Sexual Harassment policy on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Sexual Harassment policy ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Sexual Harassment policy on the notice Board?"},
q10:{hi:"क्या Fair Practice Code  Notice बोर्ड पर प्रदर्शित है?/Is Fair Practice Code on the notice Board?",
te:"నోటీసు బోర్డులో  Fair Practice Code   ప్రదర్శించబడిందా?/Is Fair Practice Code on the notice Board?",
ta:"அறிவிப்பு பலகையில் Fair Practice Code  காட்டப்பட்டுள்ளதா?/Is Fair Practice Code on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Fair Practice Code ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Fair Practice Code on the notice Board?"},
q11:{hi:"क्या Consumer Education Literature on SMA, NPA Classification and Upgradation  Notice बोर्ड पर प्रदर्शित है?/Is Consumer Education Literature on SMA, NPA Classification and Upgradation on the notice Board?",
te:"నోటీసు బోర్డులో  Consumer Education Literature on SMA, NPA Classification and Upgradation   ప్రదర్శించబడిందా?/Is Consumer Education Literature on SMA, NPA Classification and Upgradation on the notice Board?",
ta:"அறிவிப்பு பலகையில் Consumer Education Literature on SMA, NPA Classification and Upgradation  காட்டப்பட்டுள்ளதா?/Is Consumer Education Literature on SMA, NPA Classification and Upgradation on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Consumer Education Literature on SMA, NPA Classification and Upgradation ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Consumer Education Literature on SMA, NPA Classification and Upgradation on the notice Board?"},
q12:{hi:"क्या Customer Grievance Redressal Mechanism  Notice बोर्ड पर प्रदर्शित है?/Is Customer Grievance Redressal Mechanism on the notice Board?",
te:"నోటీసు బోర్డులో  Customer Grievance Redressal Mechanism   ప్రదర్శించబడిందా?/Is Customer Grievance Redressal Mechanism on the notice Board?",
ta:"அறிவிப்பு பலகையில் Customer Grievance Redressal Mechanism  காட்டப்பட்டுள்ளதா?/Is Customer Grievance Redressal Mechanism on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Customer Grievance Redressal Mechanism ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Customer Grievance Redressal Mechanism on the notice Board?"},
q13:{hi:"क्या Ombudsman certificate ( 3 languages)  Notice बोर्ड पर प्रदर्शित है?/Is Ombudsman certificate ( 3 languages) on the notice Board?",
te:"నోటీసు బోర్డులో  Ombudsman certificate ( 3 languages)   ప్రదర్శించబడిందా?/Is Ombudsman certificate ( 3 languages) on the notice Board?",
ta:"அறிவிப்பு பலகையில் Ombudsman certificate ( 3 languages)  காட்டப்பட்டுள்ளதா?/Is Ombudsman certificate ( 3 languages) on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Ombudsman certificate ( 3 languages) ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Ombudsman certificate ( 3 languages) on the notice Board?"},
q14:{hi:"क्या S&E certificate  Notice बोर्ड पर प्रदर्शित है?/Is S&E certificate on the notice Board?",
te:"నోటీసు బోర్డులో  S&E certificate   ప్రదర్శించబడిందా?/Is S&E certificate on the notice Board?",
ta:"அறிவிப்பு பலகையில் S&E certificate  காட்டப்பட்டுள்ளதா?/Is S&E certificate on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  S&E certificate ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is S&E certificate on the notice Board?"},
q15:{hi:"क्या GSTN certificate  Notice बोर्ड पर प्रदर्शित है?/Is GSTN certificate on the notice Board?",
te:"నోటీసు బోర్డులో  GSTN certificate   ప్రదర్శించబడిందా?/Is GSTN certificate on the notice Board?",
ta:"அறிவிப்பு பலகையில் GSTN certificate  காட்டப்பட்டுள்ளதா?/Is GSTN certificate on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  GSTN certificate ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is GSTN certificate on the notice Board?"},
q16:{hi:"क्या Holiday List  Notice बोर्ड पर प्रदर्शित है?/Is Holiday List on the notice Board?",
te:"నోటీసు బోర్డులో  Holiday List   ప్రదర్శించబడిందా?/Is Holiday List on the notice Board?",
ta:"அறிவிப்பு பலகையில் Holiday List  காட்டப்பட்டுள்ளதா?/Is Holiday List on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Holiday List ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Holiday List on the notice Board?"},
q17:{hi:"क्या Trade License  Notice बोर्ड पर प्रदर्शित है?/Is Trade License on the notice Board?",
te:"నోటీసు బోర్డులో  Trade License   ప్రదర్శించబడిందా?/Is Trade License on the notice Board?",
ta:"அறிவிப்பு பலகையில் Trade License  காட்டப்பட்டுள்ளதா?/Is Trade License on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  Trade License ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is Trade License on the notice Board?"},
q18:{hi:"क्या ISO certificate  Notice बोर्ड पर प्रदर्शित है?/Is ISO certificate on the notice Board?",
te:"నోటీసు బోర్డులో  ISO certificate   ప్రదర్శించబడిందా?/Is ISO certificate on the notice Board?",
ta:"அறிவிப்பு பலகையில் ISO certificate  காட்டப்பட்டுள்ளதா?/Is ISO certificate on the notice Board?",
kn:"ಸೂಚನಾ ಫಲಕದಲ್ಲಿ  ISO certificate ಎಂದು ಪ್ರದರ್ಶಿಸಲಾಗಿದೆಯೇ?/Is ISO certificate on the notice Board?"}
};

const STATE_LANG={
"Andhra Pradesh":"te","Telangana":"te",
"Tamil Nadu":"ta","Karnataka":"kn",
"Delhi":"hi","Gujarat":"hi","Maharashtra":"hi",
"Rajasthan":"hi","Uttar Pradesh":"hi","West Bengal":"hi",
"Punjab":"hi","Haryana":"hi","Madhya Pradesh":"hi",
"Odisha":"hi","Puducherry":"ta","Jharkhand":"hi","Chandigarh":"hi"
};

function applyLanguage(){
 const lang=STATE_LANG[state.value]||"hi";
 Object.keys(QUESTIONS).forEach(q=>{
   document.getElementById(q+"Text").innerText=QUESTIONS[q][lang];
 });
}
  // Photo preview dikhane ke liye ye function zaroori hai
function showPreview(event, imgId) {
  const file = event.target.files[0];
  const preview = document.getElementById(imgId);
  
  if (file) {
    const reader = new FileReader();
    reader.onload = function(e) {
      preview.src = e.target.result;
      preview.style.display = "block"; // Image select hote hi dikh jayegi
    };
    reader.readAsDataURL(file);
  }
}
  function showPreview(event, imgId) {
  const file = event.target.files[0];
  const preview = document.getElementById(imgId);
  
  if (file) {
    const reader = new FileReader();
    reader.onload = function(e) {
      preview.src = e.target.result;
      preview.style.display = "block"; // Image select hone par dikhayen
    };
    reader.readAsDataURL(file);
  }
}
</script>

</body>
</html>





